# Nova KMS Client Example

This example demonstrates how to build a client application that securely interacts with the Nova KMS service using:
1.  **Service Discovery**: Resolves KMS node URLs via `KMSRegistry` and `NovaAppRegistry`.
2.  **PoP Authentication**: Authenticates requests using Proof-of-Possession (PoP) signatures generated by the specific TEE identity (via `Odyn`).

## Features

- **Automated Testing**: Periodically (every 10s) picks a random KMS node and runs a full cycle:
    - `/kms/derive` (Key Derivation)
    - `/kms/data` (Write & Read Encrypted Data)
- **Log Exposure**: Exposes interaction logs via `GET /logs` (no UI, just JSON).
- **Helios Integration**: Waits for the embedded Helios light client to sync before starting testing.

## Prerequisites

- Python 3.11+
- `pip`
- Access to a running `nova-kms` instance (simulation or production).

## Configuration

This client discovers KMS nodes via on-chain registries:

- `KMSRegistry` for the operator set
- `NovaAppRegistry` for mapping operator wallet -> instance URL

Configure these addresses in `enclave/config.py` before building/deploying:

- `NOVA_APP_REGISTRY_ADDRESS`
- `KMS_REGISTRY_ADDRESS`

## Running in Enclave (Production)

The client is designed to run as a Nova App.

1.  **Build**:
    ```bash
    enclaver build
    ```

2.  **Deploy**:
    Follow standard Nova deployment workflow.

    Ensure `NOVA_APP_REGISTRY_ADDRESS` and `KMS_REGISTRY_ADDRESS` are correctly set in `enclave/config.py` in the image you deploy.
