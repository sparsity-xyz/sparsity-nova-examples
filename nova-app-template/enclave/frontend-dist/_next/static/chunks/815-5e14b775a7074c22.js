"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[815],{3815:function(t,e,n){let r;n.d(e,{$3:function(){return D},E9:function(){return P},P6:function(){return W},ZV:function(){return J}});let f={p:0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2fn,n:0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141n,h:1n,a:0n,b:7n,Gx:0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798n,Gy:0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8n},{p:i,n:a,Gx:l,Gy:u,b:s}=f,o=32,c={publicKey:o+1,publicKeyUncompressed:65,signature:64,seed:o+o/2},d=(...t)=>{"captureStackTrace"in Error&&"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(...t)},h=(t="")=>{let e=Error(t);throw d(e,h),e},y=t=>"bigint"==typeof t,b=t=>"string"==typeof t,p=t=>t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name,g=(t,e,n="")=>{let r=p(t),f=t?.length,i=void 0!==e;return(!r||i&&f!==e)&&h((n&&`"${n}" `)+"expected Uint8Array"+(i?` of length ${e}`:"")+", got "+(r?`length=${f}`:`type=${typeof t}`)),t},m=t=>new Uint8Array(t),A=(t,e)=>t.toString(16).padStart(e,"0"),x=t=>Array.from(g(t)).map(t=>A(t,2)).join(""),v={_0:48,_9:57,A:65,F:70,a:97,f:102},w=t=>t>=v._0&&t<=v._9?t-v._0:t>=v.A&&t<=v.F?t-(v.A-10):t>=v.a&&t<=v.f?t-(v.a-10):void 0,E=t=>{let e="hex invalid";if(!b(t))return h(e);let n=t.length,r=n/2;if(n%2)return h(e);let f=m(r);for(let n=0,i=0;n<r;n++,i+=2){let r=w(t.charCodeAt(i)),a=w(t.charCodeAt(i+1));if(void 0===r||void 0===a)return h(e);f[n]=16*r+a}return f},B=()=>globalThis?.crypto,Z=(...t)=>{let e=m(t.reduce((t,e)=>t+g(e).length,0)),n=0;return t.forEach(t=>{e.set(t,n),n+=t.length}),e},V=(t=o)=>B().getRandomValues(m(t)),k=BigInt,K=(t,e,n,r="bad number: out of range")=>y(t)&&e<=t&&t<n?t:h(r),S=(t,e=i)=>{let n=t%e;return n>=0n?n:e+n},U=t=>S(t,a),_=(t,e)=>{(0n===t||e<=0n)&&h("no inverse n="+t+" mod="+e);let n=S(t,e),r=e,f=0n,i=1n,a=1n,l=0n;for(;0n!==n;){let t=r/n,e=r%n,u=f-a*t,s=i-l*t;r=n,n=e,f=a,i=l,a=u,l=s}return 1n===r?S(f,e):h("no inverse")},X=t=>t instanceof P?t:h("Point expected"),Y=t=>S(S(t*t)*t+s),q=t=>K(t,0n,i),C=t=>K(t,1n,i),$=t=>K(t,1n,a),R=t=>(1n&t)===0n,T=t=>Uint8Array.of(t),N=t=>T(R(t)?2:3),O=t=>{let e=Y(C(t)),n=1n;for(let t=e,r=(i+1n)/4n;r>0n;r>>=1n)1n&r&&(n=n*t%i),t=t*t%i;return S(n*n)===e?n:h("sqrt invalid")};class P{static BASE;static ZERO;X;Y;Z;constructor(t,e,n){this.X=q(t),this.Y=C(e),this.Z=q(n),Object.freeze(this)}static CURVE(){return f}static fromAffine(t){let{x:e,y:n}=t;return 0n===e&&0n===n?F:new P(e,n,1n)}static fromBytes(t){let e;g(t);let{publicKey:n,publicKeyUncompressed:r}=c,f=t.length,i=t[0],a=t.subarray(1),l=H(a,0,o);if(f===n&&(2===i||3===i)){let t=O(l),n=R(t);R(k(i))!==n&&(t=S(-t)),e=new P(l,t,1n)}return f===r&&4===i&&(e=new P(l,H(a,o,64),1n)),e?e.assertValidity():h("bad point: not on curve")}static fromHex(t){return P.fromBytes(E(t))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}equals(t){let{X:e,Y:n,Z:r}=this,{X:f,Y:i,Z:a}=X(t),l=S(e*a),u=S(f*r),s=S(n*a),o=S(i*r);return l===u&&s===o}is0(){return this.equals(F)}negate(){return new P(this.X,S(-this.Y),this.Z)}double(){return this.add(this)}add(t){let{X:e,Y:n,Z:r}=this,{X:f,Y:i,Z:a}=X(t),l=0n,u=0n,o=0n,c=S(3n*s),d=S(e*f),h=S(n*i),y=S(r*a),b=S(e+n),p=S(f+i);b=S(b*p),p=S(d+h),b=S(b-p),p=S(e+r);let g=S(f+a);return p=S(p*g),g=S(d+y),p=S(p-g),g=S(n+r),l=S(i+a),g=S(g*l),l=S(h+y),g=S(g-l),o=S(0n*p),l=S(c*y),o=S(l+o),l=S(h-o),o=S(h+o),u=S(l*o),h=S(d+d),h=S(h+d),y=S(0n*y),p=S(c*p),h=S(h+y),y=S(d-y),y=S(0n*y),p=S(p+y),d=S(h*p),u=S(u+d),d=S(g*p),l=S(b*l),l=S(l-d),d=S(b*h),o=S(g*o),new P(l,u,o=S(o+d))}subtract(t){return this.add(X(t).negate())}multiply(t,e=!0){if(!e&&0n===t)return F;if($(t),1n===t)return this;if(this.equals(j))return tf(t).p;let n=F,r=j;for(let f=this;t>0n;f=f.double(),t>>=1n)1n&t?n=n.add(f):e&&(r=r.add(f));return n}multiplyUnsafe(t){return this.multiply(t,!1)}toAffine(){let{X:t,Y:e,Z:n}=this;if(this.equals(F))return{x:0n,y:0n};if(1n===n)return{x:t,y:e};let r=_(n,i);return 1n!==S(n*r)&&h("inverse invalid"),{x:S(t*r),y:S(e*r)}}assertValidity(){let{x:t,y:e}=this.toAffine();return C(t),C(e),S(e*e)===Y(t)?this:h("bad point: not on curve")}toBytes(t=!0){let{x:e,y:n}=this.assertValidity().toAffine(),r=z(e);return t?Z(N(n),r):Z(T(4),r,z(n))}toHex(t){return x(this.toBytes(t))}}let j=new P(l,u,1n),F=new P(0n,1n,0n);P.BASE=j,P.ZERO=F;let G=t=>k("0x"+(x(t)||"0")),H=(t,e,n)=>G(t.subarray(e,n)),M=2n**256n,z=t=>E(A(K(t,0n,M),64)),I=t=>K(G(g(t,o,"secret key")),1n,a,"invalid secret key: outside of range"),D=(t,e=!0)=>j.multiply(I(t)).toBytes(e);m(0),T(0),T(1);let J=(t,e,n=!0)=>P.fromBytes(e).multiply(I(t)).toBytes(n),L=(t=V(c.seed))=>(g(t),(t.length<c.seed||t.length>1024)&&h("expected 40-1024b"),z(S(G(t),a-1n)+1n)),Q=t=>e=>{let n=L(e);return{secretKey:n,publicKey:t(n)}};Q(D);let W={isValidSecretKey:t=>{try{return!!I(t)}catch(t){return!1}},isValidPublicKey:(t,e)=>{let{publicKey:n,publicKeyUncompressed:r}=c;try{let f=t.length;if(!0===e&&f!==n||!1===e&&f!==r)return!1;return!!P.fromBytes(t)}catch(t){return!1}},randomSecretKey:L},tt=t=>{let e=I(t),{x:n,y:r}=j.multiply(e).assertValidity().toAffine();return{d:R(r)?e:U(-e),px:z(n)}};Q(t=>tt(t).px);let te=Math.ceil(32)+1,tn=()=>{let t=[],e=j,n=e;for(let r=0;r<te;r++){n=e,t.push(n);for(let r=1;r<128;r++)n=n.add(e),t.push(n);e=n.double()}return t},tr=(t,e)=>{let n=e.negate();return t?n:e},tf=t=>{let e=r||(r=tn()),n=F,f=j,i=k(255),a=k(8);for(let r=0;r<te;r++){let l=Number(t&i);t>>=a,l>128&&(l-=256,t+=1n);let u=128*r,s=u+Math.abs(l)-1,o=r%2!=0,c=l<0;0===l?f=f.add(tr(o,e[u])):n=n.add(tr(c,e[s]))}return 0n!==t&&h("invalid wnaf"),{p:n,f}}}}]);