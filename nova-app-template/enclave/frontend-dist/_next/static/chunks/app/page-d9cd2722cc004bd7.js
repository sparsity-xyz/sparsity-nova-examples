(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4204:function(e,t,a){Promise.resolve().then(a.bind(a,7455))},7455:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var s=a(7437),r=a(2265),n=a(3815);let l=e=>Array.from(e instanceof Uint8Array?e:new Uint8Array(e)).map(e=>e.toString(16).padStart(2,"0")).join(""),i=e=>{e.startsWith("0x")&&(e=e.slice(2));let t=new Uint8Array(e.length/2);for(let a=0;a<e.length;a+=2)t[a/2]=parseInt(e.substr(a,2),16);return t};function c(e,t){var a;let s=(null===(a=btoa(new Uint8Array(t).reduce((e,t)=>e+String.fromCharCode(t),"")).match(/.{1,64}/g))||void 0===a?void 0:a.join("\n"))||"";return"-----BEGIN ".concat(e,"-----\n").concat(s,"\n-----END ").concat(e,"-----")}function o(e){for(let t=0;t<e.length;t++){let a=e.charCodeAt(t);if(!(a>=32&&a<=126||13===a||10===a||9===a))return!1}return!0}function d(e){if(e instanceof Uint8Array||e instanceof ArrayBuffer){let t=e instanceof Uint8Array?e:new Uint8Array(e);try{let e=new TextDecoder().decode(t);if(o(e))return e}catch(e){}return btoa(t.reduce((e,t)=>e+String.fromCharCode(t),""))}if(e instanceof Map){let t={};for(let[a,s]of Array.from(e.entries()))t[String(a)]=d(s);return t}if(Array.isArray(e))return e.map(e=>d(e));if(null!==e&&"object"==typeof e){let t={};for(let[a,s]of Object.entries(e))t[a]=d(s);return t}return e}function u(e){let t=e.public_key;e instanceof Map&&(t=e.get("public_key"));let a=d(e),s=e instanceof Map?e.get("pcrs"):e.pcrs;if(s){let e={};if(s instanceof Map)for(let[t,a]of Array.from(s.entries()))e[String(t)]=a instanceof Uint8Array?l(a):d(a);else for(let[t,a]of Object.entries(s))e[t]=a instanceof Uint8Array?l(a):d(a);a.pcrs=e}if(t instanceof Uint8Array){let e=function(e){let t=new Uint8Array([48,118,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,3,98,0]);if(120===e.length&&48===e[0])return e;if(97!==e.length)return console.warn("[rawToDer] Unexpected key length ".concat(e.length,", returning as-is")),e;let a=new Uint8Array(t.length+e.length);return a.set(t,0),a.set(e,t.length),a}(t);a.public_key=l(e)}let r=e instanceof Map?e.get("certificate"):e.certificate;r instanceof Uint8Array&&(a.certificate=c("CERTIFICATE",r));let n=e instanceof Map?e.get("cabundle"):e.cabundle;Array.isArray(n)&&(a.cabundle=n.map(e=>e instanceof Uint8Array?c("CERTIFICATE",e):d(e)));let i=e instanceof Map?e.get("user_data"):e.user_data;if(i instanceof Uint8Array)try{let e=new TextDecoder().decode(i);if(o(e))try{a.user_data=JSON.parse(e)}catch(t){a.user_data=e}else a.user_data=l(i)}catch(e){a.user_data=l(i)}return a}async function x(e){let t=await a.e(693).then(a.t.bind(a,4693,23)),s=atob(e),r=new Uint8Array(s.length);for(let e=0;e<s.length;e++)r[e]=s.charCodeAt(e);try{let e=t.decode(r);if(Array.isArray(e)&&e.length>=3){let a=e[0],s=a;if(a instanceof Uint8Array)try{s=t.decode(a)}catch(e){}let r=e[1],n=e[2],i=e.length>3?e[3]:null,c=t.decode(n),o=u(c);return{protected_header:d(s),unprotected_header:d(r),attestation_document:o,signature:i instanceof Uint8Array?l(i):d(i),module_id:o.module_id,digest:o.digest,timestamp:o.timestamp,pcrs:o.pcrs,public_key:o.public_key,user_data:"object"==typeof o.user_data?JSON.stringify(o.user_data):o.user_data,certificate:o.certificate,cabundle:o.cabundle,nonce:o.nonce}}{let t=u(e);return{attestation_document:t,module_id:t.module_id,digest:t.digest,timestamp:t.timestamp,pcrs:t.pcrs,public_key:t.public_key,user_data:"object"==typeof t.user_data?JSON.stringify(t.user_data):t.user_data,certificate:t.certificate,cabundle:t.cabundle,nonce:t.nonce}}}catch(e){throw console.error("Failed to parse CBOR attestation:",e),Error("Failed to parse attestation data")}}async function h(e,t){let a="".concat(e.replace(/\/$/,""),"/.well-known/attestation"),s={};t&&(s.nonce=btoa(t));let r=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/cbor, application/octet-stream, application/json"},body:JSON.stringify(s)});if(!r.ok)throw Error("Failed to fetch attestation: ".concat(r.status));let n=r.headers.get("content-type")||"";if(n.includes("application/cbor")||n.includes("application/octet-stream")){let e=btoa(new Uint8Array(await r.arrayBuffer()).reduce((e,t)=>e+String.fromCharCode(t),""));return{...await x(e),raw_doc:e}}{let e=await r.json();if(e.attestation_document)return{...e,raw_doc:e.attestation_doc||JSON.stringify(e)};if(e.attestation_doc)return{...await x(e.attestation_doc),raw_doc:e.attestation_doc};throw Error("Unexpected attestation response format")}}function p(e){return Array.from(e instanceof Uint8Array?e:new Uint8Array(e)).map(e=>e.toString(16).padStart(2,"0")).join("")}function m(e,t){if("P-384"===t){if(120===e.length)return e.slice(23);if(97===e.length)return e}if("secp256k1"===t){if(88===e.length)return e.slice(23);if(65===e.length)return e}return console.warn("[derToRaw] Unexpected key length ".concat(e.length," for curve ").concat(t)),e}function b(e,t){if("P-384"===t){let t=i("3076301006072a8648ce3d020106082b81040022036200"),a=new Uint8Array(t.length+e.length);return a.set(t,0),a.set(e,t.length),a}{let t=i("3056301006072a8648ce3d020106052b8104000a034200"),a=new Uint8Array(t.length+e.length);return a.set(t,0),a.set(e,t.length),a}}class f{get baseUrl(){return this.enclaveBaseUrl}get connected(){return this.isConnected}async connect(e){this.enclaveBaseUrl=e.replace(/\/$/,"");let t=await this.fetchAttestation();if(this.curve=function(e){if(e.includes("2b81040022"))return"P-384";if(e.includes("2b8104000a"))return"secp256k1";let t=e.length;return 240===t||194===t?"P-384":176===t||130===t?"secp256k1":t>160?"P-384":"secp256k1"}(t.public_key),console.log("[EnclaveClient] Detected curve: ".concat(this.curve)),"P-384"===this.curve){this.p384KeyPair=await crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-384"},!0,["deriveBits"]);let e=m(i(t.public_key),"P-384");this.serverP384Key=await crypto.subtle.importKey("raw",e,{name:"ECDH",namedCurve:"P-384"},!0,[])}else{this.secpPrivKey=n.P6.randomSecretKey(),this.secpPubKey=n.$3(this.secpPrivKey,!1);let e=i(t.public_key);this.serverSecpPubKeyRaw=m(e,"secp256k1");try{let e=Array.from(this.serverSecpPubKeyRaw).map(e=>e.toString(16).padStart(2,"0")).join("");n.E9.fromHex(e)}catch(e){throw Error("Invalid server public key: ".concat(e instanceof Error?e.message:String(e)))}}return this.isConnected=!0,t}async fetchAttestation(){let e=await h(this.enclaveBaseUrl),t=e.attestation_document.public_key||"";return{attestation_doc:e.raw_doc,public_key:t,parsedAttestation:JSON.stringify(e)}}async deriveSharedKey(e){let t;let a=m(i(e),this.curve);if("P-384"===this.curve){if(!this.p384KeyPair)throw Error("P-384 keys not initialized");let e=await crypto.subtle.importKey("raw",a,{name:"ECDH",namedCurve:"P-384"},!0,[]);t=await crypto.subtle.deriveBits({name:"ECDH",public:e},this.p384KeyPair.privateKey,384)}else{if(!this.secpPrivKey)throw Error("secp256k1 keys not initialized");t=n.ZV(this.secpPrivKey,a).slice(1,33).buffer}let s=await crypto.subtle.importKey("raw",t,{name:"HKDF"},!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"HKDF",hash:"SHA-256",salt:new TextEncoder().encode("Nova-RATLS-v1"),info:new TextEncoder().encode("encryption data")},s,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async encrypt(e){let t;if(!this.isConnected)throw Error("Not connected");let a=await this.fetchAttestation(),s=await this.deriveSharedKey(a.public_key),r=crypto.getRandomValues(new Uint8Array(32)),n=await crypto.subtle.encrypt({name:"AES-GCM",iv:r.slice(0,12)},s,new TextEncoder().encode(e));return t="P-384"===this.curve?b(new Uint8Array(await crypto.subtle.exportKey("raw",this.p384KeyPair.publicKey)),"P-384"):b(this.secpPubKey,"secp256k1"),{nonce:p(r),public_key:p(t),data:p(n)}}async decrypt(e){if(!this.isConnected)throw Error("Not connected");let t=await this.deriveSharedKey(e.public_key),a=i(e.nonce).slice(0,12),s=await crypto.subtle.decrypt({name:"AES-GCM",iv:a},t,i(e.encrypted_data));return new TextDecoder().decode(s)}async callEncrypted(e,t){let a=JSON.stringify(t),s=await this.encrypt(a),r=await fetch("".concat(this.enclaveBaseUrl).concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok)throw Error("Request failed: ".concat(r.status," ").concat(r.statusText));let n=await r.json();return n.data&&n.data.encrypted_data?JSON.parse(await this.decrypt(n.data)):n}async call(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",a=arguments.length>2?arguments[2]:void 0,s={method:t,headers:{"Content-Type":"application/json"}};a&&"POST"===t&&(s.body=JSON.stringify(a));let r=await fetch("".concat(this.enclaveBaseUrl).concat(e),s);if(!r.ok)throw Error("Request failed: ".concat(r.status," ").concat(r.statusText));return r.json()}async checkHealth(){return this.call("/health")}constructor(){this.enclaveBaseUrl="",this.isConnected=!1,this.curve="P-384",this.p384KeyPair=null,this.serverP384Key=null,this.secpPrivKey=null,this.secpPubKey=null,this.serverSecpPubKeyRaw=null}}function y(){var e,t,a,n,l,i,c,o,d;let[u]=(0,r.useState)(()=>new f),[x,h]=(0,r.useState)({connected:!1,enclaveUrl:""}),[p,m]=(0,r.useState)(!1),[b,y]=(0,r.useState)("identity"),[g,v]=(0,r.useState)(null),[w,N]=(0,r.useState)(!1),[j,k]=(0,r.useState)(!1),[S,_]=(0,r.useState)(null),[A,E]=(0,r.useState)(null),[C,P]=(0,r.useState)("Hello from Nova!"),[T,U]=(0,r.useState)("user_settings"),[D,K]=(0,r.useState)('{"theme": "dark"}');(0,r.useEffect)(()=>{{let e=window.location.origin;(e.includes("sparsity.cloud")||e.includes("localhost:8000"))&&h(t=>({...t,enclaveUrl:e}))}},[]);let O=async()=>{if(x.enclaveUrl){m(!0);try{let e=await u.connect(x.enclaveUrl),t=await u.call("/status");h({...x,connected:!0,teeAddress:t.eth_address,error:void 0}),v({success:!0,data:{attestation:e,statusInfo:t},type:"Connection"})}catch(e){h({...x,connected:!1,error:e instanceof Error?e.message:"Connection failed"})}finally{m(!1)}}},R=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",a=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];m(!0),v(null);try{let r;r=s?await u.callEncrypted(e,a):await u.call(e,t,a),v({success:!0,data:r,type:e})}catch(t){v({success:!1,error:t instanceof Error?t.message:"Request failed",type:e})}finally{m(!1)}},B=async()=>{if(x.connected){N(!0),k(!0),_(null),E(null);try{let e=await u.fetchAttestation();E(e)}catch(e){_(e instanceof Error?e.message:"Failed to fetch attestation")}finally{k(!1)}}};return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-white via-slate-50 to-sky-50 text-slate-900 p-8 font-sans",children:[(0,s.jsx)("header",{className:"max-w-7xl mx-auto mb-12",children:(0,s.jsxs)("div",{className:"flex flex-col gap-6 rounded-3xl border border-slate-200 bg-white/95 backdrop-blur px-8 py-6 shadow-xl shadow-slate-200/50",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-6 flex-wrap",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Nova Platform"}),(0,s.jsx)("h1",{className:"text-3xl font-semibold text-slate-900 mt-2",children:"\uD83D\uDEE1️ Nova App Template"}),(0,s.jsx)("p",{className:"text-slate-500 mt-2",children:"Secure, verifiable TEE apps with RA‑TLS, S3, and on‑chain trust."})]}),(0,s.jsx)("div",{className:"min-w-[320px] flex-1 max-w-md",children:(0,s.jsxs)("div",{className:"flex items-center gap-3 rounded-2xl border border-slate-200 bg-white px-4 py-3 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("label",{className:"text-[10px] uppercase tracking-widest text-slate-400",children:"Enclave URL"}),(0,s.jsx)("input",{className:"mt-1 w-full bg-transparent text-sm text-slate-700 outline-none placeholder:text-slate-400",value:x.enclaveUrl,onChange:e=>h({...x,enclaveUrl:e.target.value}),placeholder:"https://your-app.sparsity.cloud"})]}),(0,s.jsx)("button",{onClick:O,disabled:p||x.connected,className:"px-4 py-2 rounded-xl text-sm font-semibold transition ".concat(x.connected?"bg-emerald-50 text-emerald-700 border border-emerald-200":"bg-blue-600 hover:bg-blue-500 text-white shadow-sm"),children:p?"Connecting...":x.connected?"Connected":"Connect"})]})})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-3 text-xs text-slate-500",children:[(0,s.jsx)("span",{className:"px-3 py-1 rounded-full bg-sky-50 border border-sky-100 text-sky-700",children:"RA‑TLS"}),(0,s.jsx)("span",{className:"px-3 py-1 rounded-full bg-sky-50 border border-sky-100 text-sky-700",children:"S3 Storage"}),(0,s.jsx)("span",{className:"px-3 py-1 rounded-full bg-sky-50 border border-sky-100 text-sky-700",children:"Oracles"}),(0,s.jsx)("span",{className:"px-3 py-1 rounded-full bg-sky-50 border border-sky-100 text-sky-700",children:"Event Listener"})]})]})}),(0,s.jsxs)("main",{className:"max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,s.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,s.jsxs)("section",{className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-lg shadow-slate-200/60",children:[(0,s.jsx)("h2",{className:"text-xs font-semibold text-slate-500 uppercase tracking-[0.2em] mb-4",children:"Capabilities"}),(0,s.jsx)("nav",{className:"flex flex-col gap-2",children:[{id:"identity",label:"Identity & RA-TLS",icon:"\uD83D\uDD11"},{id:"storage",label:"S3 Storage",icon:"\uD83D\uDCE6"},{id:"oracle",label:"Oracle Demo",icon:"\uD83C\uDF10"},{id:"events",label:"Event Monitor",icon:"\uD83D\uDCCA"}].map(e=>(0,s.jsxs)("button",{onClick:()=>y(e.id),className:"group flex items-center gap-3 px-4 py-3 rounded-xl transition text-left border ".concat(b===e.id?"bg-blue-50 text-slate-900 border-blue-200 shadow-sm shadow-blue-100/60":"text-slate-600 border-transparent hover:border-slate-200 hover:bg-slate-50"),children:[(0,s.jsx)("span",{className:"text-base ".concat(b===e.id?"text-blue-600":"text-slate-400 group-hover:text-slate-600"),children:e.icon}),(0,s.jsx)("span",{className:"text-sm font-medium ".concat(b===e.id?"text-slate-900":"text-slate-600 group-hover:text-slate-900"),children:e.label})]},e.id))})]}),x.connected&&(0,s.jsxs)("section",{className:"bg-white rounded-xl border border-slate-200 p-6 shadow-sm",children:[(0,s.jsx)("h2",{className:"text-xs font-semibold text-slate-500 uppercase tracking-[0.2em] mb-3",children:"Enclave Identity"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-slate-500 block mb-1",children:"TEE Wallet Address"}),(0,s.jsx)("code",{className:"text-xs bg-slate-50 px-2 py-1 rounded block truncate border border-slate-200 text-slate-700",children:x.teeAddress})]}),(0,s.jsxs)("div",{className:"flex gap-2 text-xs",children:[(0,s.jsx)("span",{className:"bg-emerald-50 text-emerald-700 px-2 py-0.5 rounded border border-emerald-200",children:"Active"}),(0,s.jsx)("span",{className:"bg-blue-50 text-blue-700 px-2 py-0.5 rounded border border-blue-200",children:"Verifiable"})]})]})]})]}),(0,s.jsx)("div",{className:"lg:col-span-2 space-y-6",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 p-8 min-h-[400px] shadow-lg shadow-slate-200/60",children:["identity"===b&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Identity & RA-TLS"}),(0,s.jsx)("p",{className:"text-slate-600 text-sm leading-relaxed mb-6",children:"Establish a secure, hardware-verifiable channel with the enclave using AWS Nitro Attestation and ECDH key exchange."}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("label",{className:"text-sm text-slate-600",children:"Message to Echo"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{className:"bg-white border border-slate-300 rounded-lg px-4 py-2 flex-1 outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition",value:C,onChange:e=>P(e.target.value)}),(0,s.jsx)("button",{onClick:()=>R("/api/echo","POST",{message:C},!0),disabled:p||!x.connected,className:"bg-blue-600 hover:bg-blue-500 text-white px-6 py-2 rounded-lg font-semibold shadow-sm disabled:opacity-50",children:"Encrypted Send"})]})]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("button",{onClick:B,disabled:p||!x.connected,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View Attestation Document →"}),(0,s.jsx)("button",{onClick:()=>{N(!1),R("/api/random","GET")},disabled:p||!x.connected,className:"text-sm text-emerald-600 hover:text-emerald-700 font-medium",children:"Fetch Hardware Entropy (NSM) →"})]})]})]}),"storage"===b&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"S3 Persistent Storage"}),(0,s.jsx)("p",{className:"text-slate-600 text-sm leading-relaxed mb-6",children:"Store and retrieve sensitive state in encrypted S3 objects. Access is restricted to this specific TEE instance."}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2 col-span-1",children:[(0,s.jsx)("label",{className:"text-sm text-slate-600",children:"Key"}),(0,s.jsx)("input",{className:"bg-white border border-slate-300 rounded-lg px-4 py-2 outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",value:T,onChange:e=>U(e.target.value)})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2 col-span-1",children:[(0,s.jsx)("label",{className:"text-sm text-slate-600",children:"Value (JSON/Text)"}),(0,s.jsx)("input",{className:"bg-white border border-slate-300 rounded-lg px-4 py-2 outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-100",value:D,onChange:e=>K(e.target.value)})]})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{onClick:()=>R("/api/storage","POST",{key:T,value:D}),disabled:p||!x.connected,className:"bg-emerald-600 hover:bg-emerald-500 text-white px-6 py-2 rounded-lg font-semibold shadow-sm flex-1",children:"Store Value"}),(0,s.jsx)("button",{onClick:()=>R("/api/storage/".concat(T),"GET"),disabled:p||!x.connected,className:"bg-slate-100 hover:bg-slate-200 text-slate-700 px-6 py-2 rounded-lg font-semibold flex-1",children:"Retrieve Key"})]}),(0,s.jsx)("button",{onClick:()=>R("/api/storage","GET"),className:"text-sm text-slate-500 hover:text-slate-700",children:"List all stored keys..."})]}),"oracle"===b&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Oracle: Internet → Chain"}),(0,s.jsx)("p",{className:"text-slate-600 text-sm leading-relaxed mb-6",children:"The enclave fetches real-time data from the internet, processes it, and signs a cryptographically secure transaction for on-chain execution."}),(0,s.jsxs)("div",{className:"bg-gradient-to-br from-slate-50 to-white border border-slate-200 rounded-2xl p-8 flex flex-col items-center justify-center gap-6 shadow-sm",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDC8E"}),(0,s.jsx)("div",{className:"text-2xl font-mono text-slate-900 tracking-tight",children:"ETH / USD"})]}),(0,s.jsx)("button",{onClick:()=>R("/api/oracle/price","GET"),disabled:p||!x.connected,className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white px-8 py-3 rounded-xl font-semibold shadow-lg shadow-blue-200/60",children:"Fetch & Sign Update"})]})]}),"events"===b&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"On-Chain Event Monitor"}),(0,s.jsx)("p",{className:"text-slate-600 text-sm leading-relaxed mb-6",children:"Background workers in the enclave monitor blockchain events and respond automatically. The state hash is updated periodically to ensure data integrity."}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200",children:[(0,s.jsx)("label",{className:"text-xs text-slate-500 block mb-1",children:"Last Cron Run"}),(0,s.jsx)("span",{className:"text-sm font-mono text-emerald-600 italic",children:x.connected&&(null==g?void 0:null===(t=g.data)||void 0===t?void 0:null===(e=t.cron_info)||void 0===e?void 0:e.last_run)?new Date(g.data.cron_info.last_run).toLocaleTimeString():"Awaiting sync..."})]}),(0,s.jsxs)("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200",children:[(0,s.jsx)("label",{className:"text-xs text-slate-500 block mb-1",children:"State Hash (Keccak256)"}),(0,s.jsx)("span",{className:"text-sm font-mono text-blue-600 italic truncate block",children:x.connected&&(null==g?void 0:null===(a=g.data)||void 0===a?void 0:a.last_state_hash)?"0x".concat(g.data.last_state_hash.slice(0,16),"..."):"Awaiting sync..."})]})]}),(0,s.jsxs)("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200",children:[(0,s.jsx)("label",{className:"text-xs text-slate-500 block mb-1",children:"Background Runner Status"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),(0,s.jsxs)("span",{className:"text-xs text-slate-600",children:["Worker active • ",(null==g?void 0:null===(l=g.data)||void 0===l?void 0:null===(n=l.cron_info)||void 0===n?void 0:n.counter)||0," tasks completed"]})]})]}),(0,s.jsx)("button",{onClick:()=>R("/status","GET"),disabled:p||!x.connected,className:"w-full py-3 border border-slate-200 rounded-xl text-sm font-medium hover:bg-slate-50 transition",children:"Refresh Background Job Stats"})]})]}),g&&(0,s.jsxs)("div",{className:"mt-8 border-t border-slate-200 pt-8 animate-in fade-in slide-in-from-top-4 duration-300",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,s.jsxs)("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest",children:["Latest Response: ",g.type]}),(0,s.jsx)("span",{className:"text-[10px] font-bold px-2 py-0.5 rounded ".concat(g.success?"bg-emerald-100 text-emerald-700":"bg-red-100 text-red-700"),children:g.success?"SUCCESS":"FAILED"})]}),(0,s.jsx)("pre",{className:"bg-slate-50 rounded-xl p-5 text-xs font-mono text-slate-700 overflow-auto max-h-[300px] border border-slate-200 whitespace-pre-wrap",children:JSON.stringify(g.data||g.error,null,2)})]})]})})]}),(0,s.jsxs)("footer",{className:"max-w-6xl mx-auto mt-12 text-center text-slate-500 text-sm",children:["Built with ",(0,s.jsx)("span",{className:"text-blue-600 font-semibold",children:"Nova Platform"})," • Powered by AWS Nitro Enclaves"]}),w&&(0,s.jsx)("div",{className:"fixed inset-0 bg-slate-900/30 backdrop-blur-sm flex items-center justify-center z-50 p-6",children:(0,s.jsxs)("div",{className:"bg-white border border-slate-200 rounded-3xl shadow-2xl max-w-5xl w-full max-h-[90vh] flex flex-col overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-8 py-5 border-b border-slate-200 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Attestation Document"}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Hardware-backed proof from AWS Nitro Enclave"})]}),(0,s.jsx)("button",{onClick:()=>N(!1),className:"text-slate-400 hover:text-slate-600 text-2xl font-bold","aria-label":"Close",children:"\xd7"})]}),(0,s.jsx)("div",{className:"px-8 py-6 overflow-auto flex-1",children:j?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),(0,s.jsx)("p",{className:"mt-4 text-slate-500",children:"Loading attestation..."})]}):S?(0,s.jsx)("div",{className:"py-8",children:(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,s.jsx)("h3",{className:"text-red-700 font-semibold mb-2",children:"Failed to fetch attestation"}),(0,s.jsx)("p",{className:"text-red-600 text-sm",children:S})]})}):A?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"bg-slate-50 border border-slate-200 rounded-2xl p-4",children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-widest text-slate-500",children:"Module ID"}),(0,s.jsx)("p",{className:"mt-2 text-sm text-slate-800 break-all",children:(null===(i=A.attestation_document)||void 0===i?void 0:i.module_id)||"—"})]}),(0,s.jsxs)("div",{className:"bg-slate-50 border border-slate-200 rounded-2xl p-4",children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-widest text-slate-500",children:"Timestamp"}),(0,s.jsx)("p",{className:"mt-2 text-sm text-slate-800",children:(null===(c=A.attestation_document)||void 0===c?void 0:c.timestamp)?new Date(1e3*A.attestation_document.timestamp).toISOString():"—"})]}),(0,s.jsxs)("div",{className:"bg-slate-50 border border-slate-200 rounded-2xl p-4",children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-widest text-slate-500",children:"PCRs"}),(0,s.jsxs)("p",{className:"mt-2 text-sm text-slate-800",children:[(null===(o=A.attestation_document)||void 0===o?void 0:o.pcrs)?Object.keys(A.attestation_document.pcrs).length:0," slots"]})]})]}),(0,s.jsx)("div",{className:"bg-slate-50 border border-slate-200 rounded-2xl p-4 overflow-auto max-h-[50vh]",children:(0,s.jsx)("code",{className:"text-xs text-slate-700 block whitespace-pre-wrap break-words",dangerouslySetInnerHTML:{__html:(d=JSON.stringify(A,null,2))?d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?)/g,e=>/^".*"\s*:?$/.test(e)?/":$/.test(e)?'<span class="text-sky-700 font-semibold">'.concat(e,"</span>"):'<span class="text-emerald-700">'.concat(e,"</span>"):/true|false/.test(e)?'<span class="text-violet-700">'.concat(e,"</span>"):/null/.test(e)?'<span class="text-slate-500">'.concat(e,"</span>"):'<span class="text-amber-700">'.concat(e,"</span>")):""}})})]}):null}),(0,s.jsx)("div",{className:"px-8 py-5 border-t border-slate-200 flex justify-end",children:(0,s.jsx)("button",{onClick:()=>N(!1),className:"px-4 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200",children:"Close"})})]})})]})}new f}},function(e){e.O(0,[815,971,117,744],function(){return e(e.s=4204)}),_N_E=e.O()}]);