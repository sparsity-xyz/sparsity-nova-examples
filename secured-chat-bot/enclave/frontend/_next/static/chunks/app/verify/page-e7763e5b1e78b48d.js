(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[439],{4841:function(e,t,a){Promise.resolve().then(a.bind(a,8548))},8548:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return l}});var r=a(7437),n=a(2265),s=a(5475),i=a(6986);function c(){var e;let t=(0,s.useSearchParams)(),[a,c]=(0,n.useState)(null),[l,d]=(0,n.useState)(null),[o,m]=(0,n.useState)(!1),[x,h]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=t.get("id");if(!e){h("Missing verification ID");return}try{let t=localStorage.getItem("verification_".concat(e));t?c(JSON.parse(t)):h("Verification data not found")}catch(e){h("Failed to load verification data")}},[t]);let u=async()=>{if(!(null==a?void 0:a.enclave_url)){h("Enclave URL not available");return}m(!0);try{let e=await (0,i.Hd)(a.enclave_url),t=await (0,i.u4)(e.attestation_doc);d(t)}catch(e){console.error("Attestation error:",e),h("Failed to fetch attestation")}finally{m(!1)}};return x?(0,r.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] p-8",children:(0,r.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,r.jsx)("div",{className:"p-4 bg-red-900/50 border border-red-800 rounded-lg text-red-400",children:x})})}):a?(0,r.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] p-8",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-white mb-6",children:"Message Verification"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-[#1a1a1a] rounded-lg border border-gray-800 p-4",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-300 mb-2",children:"Request"}),(0,r.jsx)("pre",{className:"text-white whitespace-pre-wrap break-words",children:a.message})]}),(0,r.jsxs)("div",{className:"bg-[#1a1a1a] rounded-lg border border-gray-800 p-4",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-300 mb-2",children:"Response"}),(0,r.jsx)("pre",{className:"text-white whitespace-pre-wrap break-words",children:a.response})]}),(0,r.jsxs)("div",{className:"bg-[#1a1a1a] rounded-lg border border-gray-800 p-4",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-300 mb-2",children:"Metadata"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Platform:"})," ",(0,r.jsx)("span",{className:"text-white",children:a.platform||"Unknown"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Model:"})," ",(0,r.jsx)("span",{className:"text-white",children:a.ai_model||"Unknown"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Timestamp:"})," ",(0,r.jsx)("span",{className:"text-white",children:(e=a.timestamp)?new Date(1e3*e).toLocaleString():"Unknown"})]})]})]}),(0,r.jsxs)("div",{className:"bg-[#1a1a1a] rounded-lg border border-gray-800 p-4",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-300 mb-2",children:"Signature"}),(0,r.jsx)("div",{className:"p-3 bg-primary/10 rounded text-primary font-mono text-sm break-all",children:a.signature})]}),(0,r.jsxs)("div",{className:"bg-[#1a1a1a] rounded-lg border border-gray-800 p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-300",children:"Attestation"}),(0,r.jsx)("button",{onClick:u,disabled:o,className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-700 disabled:opacity-50",children:o?"Loading...":l?"Refresh":"Get Attestation"})]}),l&&(0,r.jsxs)("div",{className:"space-y-3 text-xs",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Module ID:"})," ",(0,r.jsx)("code",{className:"text-white break-all",children:l.module_id})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Digest:"})," ",(0,r.jsx)("code",{className:"text-white",children:l.digest})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Timestamp:"})," ",(0,r.jsx)("span",{className:"text-white",children:new Date(l.timestamp).toLocaleString()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-400",children:"PCRs:"}),(0,r.jsx)("div",{className:"mt-1 space-y-1",children:Object.entries(l.pcrs).map(e=>{let[t,a]=e;return(0,r.jsxs)("div",{className:"text-white",children:[(0,r.jsxs)("span",{className:"text-gray-500",children:["PCR ",t,":"]})," ",(0,r.jsx)("code",{className:"break-all",children:String(a)})]},t)})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-400",children:"Public Key (hex):"}),(0,r.jsx)("pre",{className:"mt-1 p-2 bg-[#0a0a0a] rounded text-white break-all",children:(0,i.XB)(l.public_key)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-400",children:"User Data:"}),(()=>{let e=(0,i.tG)(l.user_data);return e.ethAddr?(0,r.jsxs)("div",{className:"text-primary mt-1",children:["ETH Address: ",e.ethAddr]}):(0,r.jsx)("code",{className:"text-white break-all",children:e.rawHex})})()]})]})]})]})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] p-8",children:(0,r.jsx)("div",{className:"max-w-4xl mx-auto text-gray-400",children:"Loading verification data..."})})}function l(){return(0,r.jsx)(n.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] p-8 text-gray-400",children:"Loading..."}),children:(0,r.jsx)(c,{})})}},6986:function(e,t,a){"use strict";function r(e){try{let t=atob(e),a="";for(let e=0;e<t.length;e++){let r=t.charCodeAt(e).toString(16).padStart(2,"0");a+=r}return a}catch(t){return e}}function n(e){let t=r(e);try{let a=atob(e),r=decodeURIComponent(a.split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join("")),n=JSON.parse(r);if("object"==typeof n&&null!==n)return{isJson:!0,ethAddr:n.eth_addr||void 0,rawHex:t,jsonData:n}}catch(e){}return 40===t.length?{isJson:!1,ethAddr:"0x"+t,rawHex:t}:{isJson:!1,rawHex:t}}async function s(e){let t=await a.e(693).then(a.t.bind(a,4693,23)),r=atob(e),n=new Uint8Array(r.length);for(let e=0;e<r.length;e++)n[e]=r.charCodeAt(e);let s=t.decode(n);if(!Array.isArray(s)||s.length<4)throw Error("Invalid COSE_Sign1 structure");let i=s[2],c=t.decode(i),l=(e,t,a)=>{var r,n;return e instanceof Map?null!==(r=e.get(t))&&void 0!==r?r:e.get(a):null!==(n=e[t])&&void 0!==n?n:e[a]},d=l(c,"module_id",1),o=l(c,"timestamp",2),m=l(c,"digest",3),x=l(c,"pcrs",4),h=l(c,"certificate",5),u=l(c,"cabundle",6),f=l(c,"public_key",7),g=l(c,"user_data",8),p=l(c,"nonce",9),y={};if(x){if(x instanceof Map)for(let[e,t]of Array.from(x.entries()))t instanceof Uint8Array||t instanceof ArrayBuffer?y[String(e)]=Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join(""):y[String(e)]=String(t);else for(let[e,t]of Object.entries(x))t instanceof Uint8Array||t instanceof ArrayBuffer?y[String(e)]=Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join(""):y[String(e)]=String(t)}let j=e=>e?e instanceof Uint8Array||e instanceof ArrayBuffer?btoa(String.fromCharCode.apply(null,Array.from(new Uint8Array(e)))):String(e):"",b="";return g&&(g instanceof Uint8Array||g instanceof ArrayBuffer?b=new TextDecoder().decode(new Uint8Array(g)):b="string"==typeof g?g:JSON.stringify(g)),{module_id:d?String(d):"",digest:m instanceof Uint8Array||m instanceof ArrayBuffer?Array.from(new Uint8Array(m)).map(e=>e.toString(16).padStart(2,"0")).join(""):String(m||""),timestamp:"number"==typeof o?o:0,pcrs:y,certificate:j(h),cabundle:Array.isArray(u)?u.map(e=>j(e)):[],public_key:f?f instanceof Uint8Array||f instanceof ArrayBuffer?Array.from(new Uint8Array(f)).map(e=>e.toString(16).padStart(2,"0")).join(""):String(f):"",user_data:b,nonce:p?p instanceof Uint8Array||p instanceof ArrayBuffer?Array.from(new Uint8Array(p)).map(e=>e.toString(16).padStart(2,"0")).join(""):String(p):""}}async function i(e){let t="".concat(e.replace(/\/$/,""),"/.well-known/attestation"),a=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!a.ok)throw Error("Failed to fetch attestation: ".concat(a.status));return a.json()}a.d(t,{Hd:function(){return i},XB:function(){return r},tG:function(){return n},u4:function(){return s}})}},function(e){e.O(0,[971,117,744],function(){return e(e.s=4841)}),_N_E=e.O()}]);